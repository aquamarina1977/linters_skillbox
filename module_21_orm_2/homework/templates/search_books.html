{% extends 'base.html' %}

{% block title %}Search Books{% endblock %}

{% block content %}
    <h1>Search Books</h1>
    <form id="search-form" method="GET" onsubmit="searchBooks(event)">
        <input type="text" id="keyword" placeholder="Enter keyword" required>
        <button type="submit">Search</button>
    </form>
    <div id="search-results"></div>

    <script>
        async function searchBooks(event) {
            event.preventDefault();
            const keyword = document.getElementById('keyword').value;
            const response = await fetch(`/search_books/${encodeURIComponent(keyword)}`);
            const books = await response.json();
            displayResults(books);
        }

        function displayResults(books) {
            const resultsDiv = document.getElementById('search-results');
            resultsDiv.innerHTML = '';
            if (Array.isArray(books) && books.length > 0) {
                let table = '<table><tr><th>ID</th><th>Name</th><th>Release Date</th></tr>';
                books.forEach(book => {
                    table += `<tr>
                        <td>${book.id}</td>
                        <td>${book.name}</td>
                        <td>${book.release_date}</td>
                    </tr>`;
                });
                table += '</table>';
                resultsDiv.innerHTML = table;
            } else {
                resultsDiv.innerHTML = '<p>No books found.</p>';
            }
        }
    </script>
{% endblock %}
